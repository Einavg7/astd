# Analysis of spatio-temporal data, WS 2016/7

Course schedule: 

1. Oct 17: time series: introduction: continuity, time lines, events
1. Oct 24: time series: time domain, autocorrelation, AR, MA
1. Oct 31: time series: frequency domain
1. Nov 7: time series: estimation, forecasting; multiple time series
1. Nov 14: spatial processes: spatial correlation, variogram
1. Nov 21: simple, ordinary, universal kriging
1. Nov 28: co-kriging, block kriging, stochastic simulation
1. Dec 5: (probably no class)
1. Dec 12: spatio-temporal geostatistics: variograms
1. Dec 17: spatio-temporal geostatistics: interpolation
1. Jan 9: point patterns: spatial, temporal, spatio-temporal
1. Jan 16: areal data: estimation
1. Jan 23: project work
1. Jan 31: project work
1. Feb 6: project work

# 1. Time series

## Pen and paper exercises:
```{r}
x = c(1,2,4,5)
y = c(2,1,5,4)
data.frame(x,y)
```

1. How is the mean for a random variable $X$ defined?
1. Give the equation for covariance between two variables $x$ and $y$
1. Give the equation for correlation between two variables $x$ and $y$
1. For the samples $x$ and $y$, compute the sample mean, the variance and the standard deviation 
1. Draw the data in a scatter plot (by hand)
1. From the table above, compute the covariance between $x$ and $y$, and the correlation between $x$ and $y$
1. Suppose $x$ is a time series data, and the rows indicating the time index. Compute the lag 0, lag 1 and lag 2 autocorrelations of $x$.
1. What is the general equation of an autoregressive AR(p) process?
1. What is the general equation of a moving average MA(q) process?
1. Up to which lag is an AR(p) process correlated?
1. Up to which lag is a MA(q) process correlated?
1. What can be said about partial correlations of an AR(2) process?

## Computer exercises (studlab 125)

For those *unfamiliar* with R (note that this is a lot of work!):

1. Start R
1. Open http://www.r-project.org/ in a browser
1. Browse to Documentation: Manuals
1. Open: An Introduction to R
1. Work your way through chapters 1-9.
1. If you have time left, work your way through the exercises below:

For those familiar with R:

1. create a random walk time series of length 1000 using `rnorm` and `cumsum`, and `plot` it
1. compute and plot the autocorrelation with `acf` and partial autocorrelation with `pacf` of this series; explain what you see
1. simulate an AR(1) process using `arima.sim`; use first a coefficient of 0.9, and then a coefficient of 0.1; compute the autocorrelation function and partial autocorrelation function for both cases, and explain what you see.
1. simulate an AR(3) process of length 10000 with coefficients `c(0.7,0.15,0.05)` and compute and plot autocorrelation and partial autocorrelation functions
1. safe the series, and fit an AR model to it using `ar`. Why are the parameters not identical to those used for simulation? What can you do to make the estimated parameters closer to those used for simulation?
1. simulate a MA(10) process with constant weights `rep(1,10)`, and plot autocorrelation functions; explain what you see.
1. Consider the plot generated by `plot(stl(co2,s.window = "per"))` and describe in some detail the components into which the original time series has been decomposed. What do the grey bars at the right hand side of the sub-plots reflect?
1. Fit an AR process to the remainder of this decomposition, obtained by `stl(co2,s.window = "per")$time.series[,"remainder"]`
1. Simulate a new process with these fitted coefficients.

